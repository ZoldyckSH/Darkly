# Vulnérabilité

Page redirect : `http://192.168.1.19/index.php?page=redirect`

On peut voir que le site a une page nommée `redirect` avec un paramètre en query `site` qui redirigera l'user vers l'url passé en parametre

Par exemple, si vous faites `http://10.10.1.89/index.php?page=redirect&site=aaaa.com` vous allez avoir accès au flag

C'est une faille Open Redirect qui est utilisée pour rediriger l'user vers un autre site web sans qu'il s'en aperçoive

# Solution

Validation des entrées : Ne faites jamais confiance aux entrées fournies par les utilisateurs sans les valider. Si votre application a besoin d'une fonctionnalité de redirection, envisagez de n'autoriser que les redirections vers des chemins relatifs au lieu d'URL absolues. Si vous devez absolument permettre les redirections vers des URL absolues, assurez-vous de vérifier que l'URL est bien sur un domaine de confiance.

Liste blanche des URL : Si votre application doit rediriger vers d'autres sites, considérez l'utilisation d'une liste blanche d'URL autorisées. N'acceptez pas une URL pour la redirection à moins qu'elle ne figure sur cette liste.